System.register(["jimu-core","jimu-arcgis","jimu-ui","esri/smartMapping/renderers/pieChart"],(function(e,t){var r={},i={},n={},o={};return{setters:[function(e){r.React=e.React,r.jsx=e.jsx},function(e){i.JimuMapViewComponent=e.JimuMapViewComponent},function(e){n.Switch=e.Switch},function(e){o.createRendererForClustering=e.createRendererForClustering}],execute:function(){e((()=>{var e={2618:e=>{"use strict";e.exports=o},6826:e=>{"use strict";e.exports=i},8891:e=>{"use strict";e.exports=r},726:e=>{"use strict";e.exports=n}},t={};function a(r){var i=t[r];if(void 0!==i)return i.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,a),n.exports}a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="";var u={};return a.p=window.jimuConfig.baseUrl,(()=>{"use strict";a.r(u),a.d(u,{__set_webpack_public_path__:()=>o,default:()=>n});var e=a(8891),t=a(6826),r=a(726),i=a(2618);const n=n=>{const[o,a]=e.React.useState(),[u,s]=e.React.useState(null),[c,d]=e.React.useState(!0);return e.React.useEffect((()=>{if(n.useDataSources&&n.useDataSources.length>0){const e=n.useDataSources[0].dataSourceId.split("-")[1];s(e)}}),[n.useDataSources]),e.React.useEffect((()=>{if(!o||!u)return;const e=o.view.map.findLayerById(u);if(!e)return;d(!!e.featureReduction);const t=e.watch("featureReduction",(e=>{d(!!e)}));return()=>{t&&"function"==typeof t.remove&&t.remove()}}),[o,u]),e.React.useEffect((()=>{var e,t,r,n;e=void 0,t=void 0,n=function*(){if(!o||!u)return;const e=o.view.map.findLayerById(u);if(!e)return;const t=!!e.featureReduction;if(c&&!t){const{renderer:t,fields:r}=yield i.createRendererForClustering({layer:e});e.featureReduction={type:"cluster",fields:r,clusterMinSize:16,renderer:t}}else!c&&t&&(e.featureReduction=null)},new((r=void 0)||(r=Promise))((function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function u(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}s((n=n.apply(e,t||[])).next())}))}),[c,o,u]),(0,e.jsx)("div",{className:"cluster-toggle-widget jimu-widget"},n.useMapWidgetIds&&1===n.useMapWidgetIds.length&&(0,e.jsx)(t.JimuMapViewComponent,{useMapWidgetId:n.useMapWidgetIds[0],onActiveViewChange:e=>{e&&a(e)}}),(0,e.jsx)("div",{style:{display:"inline-flex",alignItems:"center",gap:8,padding:"6px 10px",borderRadius:999,background:"rgba(148, 163, 184, 0.5)",color:"#0f172a",boxShadow:"0 6px 16px rgba(0, 0, 0, 0.2)",border:"1px solid rgba(148, 163, 184, 0.9)",backdropFilter:"blur(4px)",cursor:"pointer",maxWidth:260,minHeight:32},onClick:()=>d(!c)},(0,e.jsx)("div",{style:{width:22,height:22,borderRadius:"50%",background:"conic-gradient(#6efce3 0deg 120deg, #fca311 120deg 240deg, #64b5f6 240deg 360deg)",border:"2px solid rgba(15,23,42,0.9)",flexShrink:0}}),(0,e.jsx)("div",{onClick:e=>e.stopPropagation(),style:{paddingLeft:2}},(0,e.jsx)(r.Switch,{checked:c,onChange:()=>d(!c),"aria-label":"Cluster"}))))};function o(e){a.p=e}})(),u})())}}}));