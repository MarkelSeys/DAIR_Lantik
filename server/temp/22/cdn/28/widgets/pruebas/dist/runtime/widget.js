/*! For license information please see widget.js.LICENSE.txt */
System.register(["jimu-core","jimu-core/react","jimu-core/react-dom","jimu-arcgis","jimu-ui/advanced/setting-components","esri/renderers/UniqueValueRenderer","esri/smartMapping/renderers/pieChart","jimu-ui"],(function(e,o){var t={},r={},a={},n={},i={},l={},c={},s={};return Object.defineProperty(r,"__esModule",{value:!0}),{setters:[function(e){t.Immutable=e.Immutable,t.JimuFieldType=e.JimuFieldType,t.React=e.React,t.appActions=e.appActions,t.getAppStore=e.getAppStore},function(e){Object.keys(e).forEach((function(o){r[o]=e[o]}))},function(e){a.unstable_batchedUpdates=e.unstable_batchedUpdates},function(e){n.JimuMapViewComponent=e.JimuMapViewComponent},function(e){i.SettingSection=e.SettingSection},function(e){l.default=e.default},function(e){c.createRendererForClustering=e.createRendererForClustering},function(e){s.Button=e.Button,s.Loading=e.Loading,s.MultiSelect=e.MultiSelect,s.Select=e.Select}],execute:function(){e((()=>{var e={8679:(e,o,t)=>{"use strict";var r=t(9864),a={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},n={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},l={};function c(e){return r.isMemo(e)?i:l[e.$$typeof]||a}l[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},l[r.Memo]=i;var s=Object.defineProperty,d=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,m=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,b=Object.prototype;e.exports=function e(o,t,r){if("string"!=typeof t){if(b){var a=p(t);a&&a!==b&&e(o,a,r)}var i=d(t);u&&(i=i.concat(u(t)));for(var l=c(o),g=c(t),f=0;f<i.length;++f){var S=i[f];if(!(n[S]||r&&r[S]||g&&g[S]||l&&l[S])){var y=m(t,S);try{s(o,S,y)}catch(e){}}}}return o}},9921:(e,o)=>{"use strict";var t="function"==typeof Symbol&&Symbol.for,r=t?Symbol.for("react.element"):60103,a=t?Symbol.for("react.portal"):60106,n=t?Symbol.for("react.fragment"):60107,i=t?Symbol.for("react.strict_mode"):60108,l=t?Symbol.for("react.profiler"):60114,c=t?Symbol.for("react.provider"):60109,s=t?Symbol.for("react.context"):60110,d=t?Symbol.for("react.async_mode"):60111,u=t?Symbol.for("react.concurrent_mode"):60111,m=t?Symbol.for("react.forward_ref"):60112,p=t?Symbol.for("react.suspense"):60113,b=t?Symbol.for("react.suspense_list"):60120,g=t?Symbol.for("react.memo"):60115,f=t?Symbol.for("react.lazy"):60116,S=t?Symbol.for("react.block"):60121,y=t?Symbol.for("react.fundamental"):60117,_=t?Symbol.for("react.responder"):60118,v=t?Symbol.for("react.scope"):60119;function h(e){if("object"==typeof e&&null!==e){var o=e.$$typeof;switch(o){case r:switch(e=e.type){case d:case u:case n:case l:case i:case p:return e;default:switch(e=e&&e.$$typeof){case s:case m:case f:case g:case c:return e;default:return o}}case a:return o}}}function w(e){return h(e)===u}o.AsyncMode=d,o.ConcurrentMode=u,o.ContextConsumer=s,o.ContextProvider=c,o.Element=r,o.ForwardRef=m,o.Fragment=n,o.Lazy=f,o.Memo=g,o.Portal=a,o.Profiler=l,o.StrictMode=i,o.Suspense=p,o.isAsyncMode=function(e){return w(e)||h(e)===d},o.isConcurrentMode=w,o.isContextConsumer=function(e){return h(e)===s},o.isContextProvider=function(e){return h(e)===c},o.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r},o.isForwardRef=function(e){return h(e)===m},o.isFragment=function(e){return h(e)===n},o.isLazy=function(e){return h(e)===f},o.isMemo=function(e){return h(e)===g},o.isPortal=function(e){return h(e)===a},o.isProfiler=function(e){return h(e)===l},o.isStrictMode=function(e){return h(e)===i},o.isSuspense=function(e){return h(e)===p},o.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===n||e===u||e===l||e===i||e===p||e===b||"object"==typeof e&&null!==e&&(e.$$typeof===f||e.$$typeof===g||e.$$typeof===c||e.$$typeof===s||e.$$typeof===m||e.$$typeof===y||e.$$typeof===_||e.$$typeof===v||e.$$typeof===S)},o.typeOf=h},9864:(e,o,t)=>{"use strict";e.exports=t(9921)},8359:(e,o)=>{"use strict";Symbol.for("react.element"),Symbol.for("react.portal"),Symbol.for("react.fragment"),Symbol.for("react.strict_mode"),Symbol.for("react.profiler"),Symbol.for("react.provider"),Symbol.for("react.context"),Symbol.for("react.server_context"),Symbol.for("react.forward_ref"),Symbol.for("react.suspense"),Symbol.for("react.suspense_list"),Symbol.for("react.memo"),Symbol.for("react.lazy"),Symbol.for("react.offscreen");Symbol.for("react.module.reference")},2973:(e,o,t)=>{"use strict";t(8359)},6334:(e,o,t)=>{"use strict";t.d(o,{default:()=>f});var r=t(8891);const a={_widgetLabel:"Leyenda dinámica",chooseAttribute:"Visualización por atributo"};var n=t(6826),i=t(1315),l=t(7756),c=t(6849),s=t(2618),d=t(726);const u=JSON.parse('{"Tipo_accidente":{"salidas_de_via":{"color":"rgba(203, 0, 203, 1)","nombre":"Salidas de vía"},"colisiones":{"color":"rgba(101, 178, 255, 1)","nombre":"Colisiones"},"alcances":{"color":"rgba(255, 153, 50, 1)","nombre":"Alcances"},"choques":{"color":"rgba(153, 255, 229, 1)","nombre":"Choques"},"otros":{"color":"rgba(0, 63, 255, 1)","nombre":"Otros"},"atropellos_de_animales":{"color":"rgba(255, 255, 50, 1)","nombre":"Atropellos de animales"},"caidas":{"color":"rgba(140, 255, 101, 1)","nombre":"Caídas"},"vuelcos":{"color":"rgba(255, 0, 197, 1)","nombre":"Vuelcos"},"atropellos_de_peatones":{"color":"rgba(216, 255, 101, 1)","nombre":"Atropellos de peatones"},"sin_datos":{"color":"rgba(182, 182, 182, 1)","nombre":"Sin datos"},"no_definido":{"color":"rgba(214, 214, 214, 1)","nombre":"No definido"}},"Sentido":{"Ascendente":{"color":"rgba(255,125,125,1)","nombre":"Ascendente"},"Descendente":{"color":"rgba(77,147,217,1)","nombre":"Descendente"},"Sin_datos":{"color":"rgba(151,151,151,1)","nombre":"Sin datos"}},"Superficie":{"no_consta":{"color":"rgba(191,191,191,1)","nombre":"No consta"},"seca_y_limpia":{"color":"rgba(190,233,173,1)","nombre":"Seca y limpia"},"umbria":{"color":"rgba(184,231,254,1)","nombre":"Umbría"},"mojada":{"color":"rgba(94,184,246,1)","nombre":"Mojada"},"muy_encharcado_o_inundado":{"color":"rgba(15,65,177,1)","nombre":"Muy encharcado o inundado"},"helada":{"color":"rgba(238,245,252,1)","nombre":"Helada"},"nevada":{"color":"rgba(255,255,243,1)","nombre":"Nevada"},"aceite":{"color":"rgba(255,255,153,1)","nombre":"Aceite"},"con_barro_o_gravilla_suelta":{"color":"rgba(255,190,125,1)","nombre":"Con barro o gravilla suelta"},"gravilla_suelta":{"color":"rgba(255,224,193,1)","nombre":"Gravilla suelta"},"barrillo":{"color":"rgba(255,155,55,1)","nombre":"Barrillo"},"otro_tipo":{"color":"rgba(217,179,255,1)","nombre":"Otro tipo"},"sin_datos":{"color":"rgba(151,151,151,1)","nombre":"Sin datos"}},"Luminosidad":{"no_consta":{"color":"rgba(191,191,191,1)","nombre":"No consta"},"luz_del_dia_natural_solar":{"color":"rgba(255,255,75,1)","nombre":"Luz del día natural, solar"},"amanecer_o_atardecer_con_luz_artificial":{"color":"rgba(255,219,105,1)","nombre":"Amanecer o atardecer con luz artificial"},"amanecer_o_atardecer_sin_luz_artificial":{"color":"rgba(255,176,97,1)","nombre":"Amanecer o atardecer sin luz artificial"},"sin_luz_natural_luz_artificial_suficiente":{"color":"rgba(255,225,255,1)","nombre":"Sin luz natural, luz artificial suficiente"},"sin_luz_natural_luz_artificial_insuficiente":{"color":"rgba(37,105,173,1)","nombre":"Sin luz natural, luz artificial insuficiente"},"sin_iluminacion_natural_ni_artificial":{"color":"rgba(21,61,100,1)","nombre":"Sin iluminación natural ni artificial"},"crepusculo":{"color":"rgba(244,191,162,1)","nombre":"Crepúsculo"},"sin_datos":{"color":"rgba(151,151,151,1)","nombre":"Sin datos"}},"Factores_atmosfericos":{"no_consta":{"color":"rgba(191,191,191,1)","nombre":"No consta"},"despejado":{"color":"rgba(255,255,75,1)","nombre":"Despejado"},"niebla_intensa":{"color":"rgba(240,241,227,1)","nombre":"Niebla intensa"},"niebla_ligera":{"color":"rgba(255,255,204,1)","nombre":"Niebla ligera"},"lluvia_debil":{"color":"rgba(185,255,255,1)","nombre":"Lluvia débil"},"lluvia_fuerte":{"color":"rgba(117,171,225,1)","nombre":"Lluvia fuerte"},"granizando":{"color":"rgba(37,105,173,1)","nombre":"Granizando"},"nevando":{"color":"rgba(21,61,100,1)","nombre":"Nevando"},"viento_fuerte":{"color":"rgba(241,169,131,1)","nombre":"Viento fuerte"},"nublado":{"color":"rgba(217,217,217,1)","nombre":"Nublado"},"otro":{"color":"rgba(217,179,255,1)","nombre":"Otro"},"sin_datos":{"color":"rgba(151,151,151,1)","nombre":"Sin datos"}},"Tipo_dia":{"festivo":{"color":"rgba(255,124,128,1)","nombre":"Festivo"},"laborable":{"color":"rgba(190,233,173,1)","nombre":"Laborable"},"posterior_a_festivo":{"color":"rgba(217,179,255,1)","nombre":"Posterior a festivo"},"vispera_de_festivo":{"color":"rgba(255,190,125,1)","nombre":"Víspera de festivo"},"sin_datos":{"color":"rgba(151,151,151,1)","nombre":"Sin datos"}},"Factor_Concurrente_3":{"adelantamiento_antirreglamentario":{"color":"rgba(255,215,175,1)","nombre":"Adelantamiento antirreglamentario"},"alcohol":{"color":"rgba(74,154,42,1)","nombre":"Alcohol"},"alcohol_o_drogas":{"color":"rgba(190,233,173,1)","nombre":"Alcohol o drogas"},"averia_mecanica":{"color":"rgba(185,255,255,1)","nombre":"Avería mecánica"},"caida_de_carga_en_la_calzada":{"color":"rgba(255,219,105,1)","nombre":"Caída de carga en la calzada"},"cansancio_sueno_o_enfermedad":{"color":"rgba(245,235,255,1)","nombre":"Cansancio, sueño o enfermedad"},"conduccion_distraida_o_desatenta":{"color":"rgba(217,179,255,1)","nombre":"Conducción distraida o desatenta"},"conduccion_negligente":{"color":"rgba(255,55,60,1)","nombre":"Conducción negligente"},"conduccion_temeraria":{"color":"rgba(255,124,128,1)","nombre":"Conducción temeraria"},"distraccion":{"color":"rgba(217,179,255,1)","nombre":"Distracción"},"drogas":{"color":"rgba(190,233,173,1)","nombre":"Drogas"},"enfermedad":{"color":"rgba(21,61,100,1)","nombre":"Enfermedad"},"estado_o_condicion_de_la_senalizacion":{"color":"rgba(238,238,238,1)","nombre":"Estado o condición de la señalización"},"estado_o_condicion_de_la_via":{"color":"rgba(191,191,191,1)","nombre":"Estado o condición de la vía"},"giro_incorrecto":{"color":"rgba(254,218,227,1)","nombre":"Giro incorrecto"},"inexperiencia_del_conductor":{"color":"rgba(176,254,235,1)","nombre":"Inexperiencia del conductor"},"infraccion_a_norma_de_circulacion":{"color":"rgba(255,175,177,1)","nombre":"Infracción a norma de circulación"},"irrumpir_animal_en_calzada":{"color":"rgba(213,171,129,1)","nombre":"Irrumpir animal en calzada"},"irrumpir_peaton_en_calzada":{"color":"rgba(164,109,54,1)","nombre":"Irrumpir peatón en calzada"},"mal_estado_del_vehiculo":{"color":"rgba(117,171,225,1)","nombre":"Mal estado del vehículo"},"meteorologia_adversa":{"color":"rgba(37,105,173,1)","nombre":"Meteorología adversa"},"no_mantener_intervalo_de_seguridad":{"color":"rgba(255,182,109,1)","nombre":"No mantener intervalo de seguridad"},"no_respetar_prioridad":{"color":"rgba(255,153,51,1)","nombre":"No respetar prioridad"},"obstaculo_en_calzada":{"color":"rgba(255,219,105,1)","nombre":"Obstáculo en calzada"},"otro_factor":{"color":"rgba(255,193,255,1)","nombre":"Otro factor"},"presencia_de_un_obstaculo_en_la_calzada":{"color":"rgba(255,219,105,1)","nombre":"Presencia de un obstáculo en la calzada"},"sin_opinion_definida":{"color":"rgba(255,255,204,1)","nombre":"Sin opinión definida"},"tramo_en_obras":{"color":"rgba(255,255,75,1)","nombre":"Tramo en obras"},"velocidad_inadecuada":{"color":"rgba(190,125,255,1)","nombre":"Velocidad inadecuada"}},"Subtipo_Accidente":{"alcance":{"color":"rgba(255,224,193,1)","nombre":"Alcance"},"multiple_o_en_caravana":{"color":"rgba(255,153,51,1)","nombre":"Múltiple o en caravana"},"caida_en_calzada":{"color":"rgba(0,255,0,1)","nombre":"Caida en calzada"},"choque_con_arbol_o_poste":{"color":"rgba(255,225,255,1)","nombre":"Choque con árbol o poste"},"choque_con_arbol_o_poste_izqd":{"color":"rgba(215,107,205,1)","nombre":"Choque con árbol o poste izqd"},"choque_con_cuneta_o_bordillo":{"color":"rgba(37,105,173,1)","nombre":"Choque con cuneta o bordillo"},"choque_con_cuneta_o_bordillo_izqd":{"color":"rgba(21,61,100,1)","nombre":"Choque con cuneta o bordillo izqd"},"choque_con_murete_o_edificio":{"color":"rgba(190,233,173,1)","nombre":"Choque con murete o edificio"},"choque_con_murete_o_edificio_izqd":{"color":"rgba(74,154,42,1)","nombre":"Choque con murete o edificio izqd"},"otro_tipo_de_choque":{"color":"rgba(213,171,129,1)","nombre":"Otro tipo de choque"},"otro_tipo_de_choque_izqd":{"color":"rgba(164,109,54,1)","nombre":"Otro tipo de choque izqd"},"en_llano":{"color":"rgba(255,255,75,1)","nombre":"En llano"},"en_llano_izqd":{"color":"rgba(255,219,105,1)","nombre":"En llano izqd"},"con_vuelco":{"color":"rgba(255,175,177,1)","nombre":"Con vuelco"},"con_vuelco_izqd":{"color":"rgba(255,124,128,1)","nombre":"Con vuelco izqd"},"con_despenamiento":{"color":"rgba(245,235,255,1)","nombre":"Con despeñamiento"},"con_despenamiento_izqd":{"color":"rgba(217,179,255,1)","nombre":"Con despeñamiento izqd"},"otra_salida":{"color":"rgba(199,199,199,1)","nombre":"Otra salida"},"otra_salida_izqd":{"color":"rgba(138,138,138,1)","nombre":"Otra salida izqd"},"solo_salida_de_via":{"color":"rgba(204,56,186,1)","nombre":"Sólo Salida de Vía"},"despenamiento":{"color":"rgba(81,21,74,1)","nombre":"Despeñamiento"},"vuelco_en_la_calzada":{"color":"rgba(253,23,138,1)","nombre":"Vuelco en la calzada"},"otro":{"color":"rgba(0,0,255,1)","nombre":"Otro"},"frontal":{"color":"rgba(192,230,245,1)","nombre":"Frontal"},"frontolateral":{"color":"rgba(94,184,246,1)","nombre":"Frontolateral"},"lateral":{"color":"rgba(6,83,136,1)","nombre":"Lateral"},"obstaculo_o_elemento_de_la_via":{"color":"rgba(176,254,235,1)","nombre":"Obstáculo o elemento de la vía"},"otro_objeto_o_material":{"color":"rgba(15,241,214,1)","nombre":"Otro objeto o material"},"vehiculo_estacionado_averiado":{"color":"rgba(10,178,158,1)","nombre":"Vehículo estacionado/averiado"},"barrera_de_paso_a_nivel":{"color":"rgba(6,98,87,1)","nombre":"Barrera de paso a nivel"},"valla_de_defensa":{"color":"rgba(11,245,156,1)","nombre":"Valla de defensa"},"choque_contra_barrera_de_seguridad":{"color":"rgba(24,130,74,1)","nombre":"Choque contra barrera de seguridad"},"peaton_aislado":{"color":"rgba(139,208,0,1)","nombre":"Peatón aislado"},"peaton_aislado_o_en_grupo":{"color":"rgba(97,146,0,1)","nombre":"Peatón aislado o en grupo"},"peaton_sosteniendo_bicicleta":{"color":"rgba(194,255,71,1)","nombre":"Peatón sosteniendo bicicleta"},"peaton_reparando_vehiculo":{"color":"rgba(159,248,144,1)","nombre":"Peatón reparando vehículo"},"conductor_de_animales":{"color":"rgba(217,201,83,1)","nombre":"Conductor de animales"},"animal_conducido_o_rebano":{"color":"rgba(255,255,0,1)","nombre":"Animal conducido o rebaño"},"animales_sueltos":{"color":"rgba(255,255,159,1)","nombre":"Animales sueltos"}}}');var m=function(e,o,t,r){return new(t||(t=Promise))((function(a,n){function i(e){try{c(r.next(e))}catch(e){n(e)}}function l(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){var o;e.done?a(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(i,l)}c((r=r.apply(e,o||[])).next())}))};const p=e=>{if(!e)return"";const o={inudado:"inundado",encharcado:"encharcado",gravilla:"gravilla",barro:"barro"};let t=e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase();Object.keys(o).forEach((e=>{t=t.replace(new RegExp(e,"g"),o[e])}));const r=["de","del","la","el","los","las","o","y"];return t=t.split(/\s+/).filter((e=>!r.includes(e))).join(" "),t=t.replace(/[^a-z0-9]+/g,"_"),t.replace(/^_|_$/g,"")},b=e=>{const o=null==e?void 0:e.match(/rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/i);return o?[Number(o[1]),Number(o[2]),Number(o[3])]:null},g=(e,o)=>{var t,r=(t=e)?t.charAt(0).toUpperCase()+t.slice(1):"";if(u[r]){for(const e in u[r])if(console.log("Primero:"+u[r][e].nombre.toLowerCase()+"      Segundo:    "+o.toLowerCase()),p(u[r][e].nombre.toLowerCase())===p(o.toLowerCase()))return u[r][e].color;return"rgb(200, 200, 200)"}return null};function f(e){var o;(0,r.Immutable)([r.JimuFieldType.String]);const[t,u]=(0,i.useState)(""),[p,f]=(0,i.useState)(),[S,y]=(0,i.useState)(""),[_,v]=(0,i.useState)((0,r.Immutable)([])),[h,w]=(0,i.useState)([]),[A,C]=(0,i.useState)(!1),[x,T]=(0,i.useState)(!0),[z,O]=(0,i.useState)([]);(0,i.useEffect)((()=>{if(e.useDataSources&&e.useDataSources.length>0){const o=e.useDataSources[0].dataSourceId.split("-")[1];y(o)}}),[e.useDataSources]);const L={Tipo_accidente:"Tipo de accidente",Subtipo_Accidente:"Subtipo de Accidente",Sentido:"Sentido",Superficie:"Superficie",Luminosidad:"Luminosidad",Factores_atmosfericos:"Factores atmosféricos",Tipo_dia:"Tipo de día",Factor_Concurrente_3:"Factor concurrente"};function F(){return[Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.floor(256*Math.random())]}function E(e){return i.default.createElement(l.SettingSection,{className:"attribute-selector-section",title:"Este atributo tiene más de 10 categorías, límite que el mapa no permite visualizar. Seleccione como máximo 9 atributos para visualizarlos en el mapa."},i.default.createElement(d.MultiSelect,{items:e,placeholder:"Selecione 9 atributos únicos",displayByValues:function(e){return`${e.length} seleccionados`},onClickItem:function(e,o,t){t.length<=10&&w(t)}}))}const D=(e,o)=>m(this,void 0,void 0,(function*(){const{renderer:r,fields:a}=yield s.createRendererForClustering({layer:e,legendOptions:{title:L[t]}}),n=[];let i;a.forEach((e=>{n.push(e.name.split("_").map((e=>e.replace("SUM",""))).join(" ").replace("SUM","").slice(1,e.name.split("_").map((e=>e.replace("SUM",""))).join(" ").replace("SUM","").length))})),i="Tipo_accidente"===t?{"Salidas de v a":"Salidas de vía",Colisiones:"Colisiones",Alcances:"Alcances",Choques:"Choques",Otros:"Otros","Atropellos de animales":"Atropellos de animales",Caidas:"Caídas",Vuelcos:"Vuelcos","Atropellos de peatones":"Atropellos de peatones","cluster default":"Agrupación","Sin datos":"Sin datos"}:function(e,o){const t={};o=o.map(String);for(const r of e){const a={},n=[];for(const l of o){let c=0;if(r.length===l.length)for(let s=0;s<r.length;s++)r[s]===l[s]&&c++;a[c]=l,n.push(c)}function i(e,o){return o-e}n.sort(i),0===n[0]?t[r]=" "===r?" ":"Agrupación":t[r]=a[n[0]]}return t}(n,o);const l=a.map((e=>({fieldName:e.name,label:i[e.name.split("_").map((e=>e.replace("SUM",""))).join(" ").replace("SUM","").slice(1,e.name.split("_").map((e=>e.replace("SUM",""))).join(" ").replace("SUM","").length)],format:{places:0,digitSeparator:!0}})));o.length<11&&l.pop();const c={title:"Resumen del clúster",content:[{type:"text",text:"This cluster represents <b>{cluster_count}</b> features. "},{type:"media",mediaInfos:[{title:"Reports",type:"pie-chart",value:{fields:l.map((e=>e.fieldName))}}]},{type:"fields"}],fieldInfos:l};r.attributes.forEach((e=>{var o;const r=e.field.split("_").map((e=>e.replace("SUM",""))).join(" ").replace("SUM",""),a=null!==(o=i[r.slice(1)])&&void 0!==o?o:r.slice(1),n=g(t,a);n&&(e.symbol=e.symbol||{},e.symbol.color=n)})),e.featureReduction={type:"cluster",fields:a,clusterMinSize:25,renderer:r,popupTemplate:c,labelingInfo:[]},C(!1)}));return(0,i.useEffect)((()=>{if(p&&t&&""!==S){const o=p.view.map.findLayerById(S),a=o.getField(t),n=o.createQuery();function i(o,t,r){const a=[],n={};for(const e of o){const o=g(r,String(e));let t,i;if(o){const e=b(o);e?(i=e,t=o):(i=F(),t=i)}else i=F(),t=i;n[String(e)]=i,a.push({value:e,label:e,symbol:{type:"simple-marker",color:t,outline:null,size:6}})}const i=new c.default({field:r,defaultSymbol:{type:"simple-marker",color:[195,195,195],outline:null,size:6},uniqueValueInfos:a});e.onAtt(n),t.renderer=i}n.outFields=[a.name],n.maxRecordCountFactor=3,(()=>m(this,void 0,void 0,(function*(){const e=[];(yield o.queryFeatures(n)).features.forEach((o=>{const t=o.attributes[a.name];e.push(t)}));const t=Array.from(new Set(e));return console.log(t),A&&((0,r.getAppStore)().getState().appConfig.attUnique=t&&t.length?t:["Salidas de vía","Colisiones","Alcances","Choques","Otros","Atropellos de animales","Caídas","Vuelcos","Atropellos de peatones","Sin datos"]),t})))().then((e=>{const t=[];if(e.forEach((e=>{const o={};null===e?(o.value="Sin datos",o.label="Sin datos"):(o.value=e.toString(),o.label=e.toString()),t.push(o)})),v(t),window.attUnique=e,window.valoresAgg=h,A){if(h.length<=25&&0!==h.length){for(const o of e){let e=0;for(const t of h)o===t&&e++;if(0===e){h.push(o);break}}i(h.slice(0,-1),o,a.name)}else i(e,o,a.name);O(e),x?D(o,e):o.featureReduction={},C(!1)}}))}w([])}),[p,t,S,A]),(0,i.useEffect)((()=>{if(p&&t&&void 0!==S){const e=p.view.map.findLayerById(S);x?D(e,z):e.featureReduction={},C(!1)}}),[x]),i.default.createElement("div",{className:"widget-setting-get-map-coordinates"},i.default.createElement("div",{className:"widget-starter jimu-widget"},e.useMapWidgetIds&&1===e.useMapWidgetIds.length&&i.default.createElement(n.JimuMapViewComponent,{useMapWidgetId:null===(o=e.useMapWidgetIds)||void 0===o?void 0:o[0],onActiveViewChange:e=>{e&&f(e)}})),e.useDataSources&&e.useDataSources.length>0&&i.default.createElement(l.SettingSection,{className:"attribute-selector-section",title:e.intl.formatMessage({id:"chooseAttributeSelectorLabel",defaultMessage:a.chooseAttribute})},i.default.createElement(d.Select,{value:t,onChange:(o,t)=>{o&&(u(o.target.value),e.onUpdate(o.target.value))},placeholder:"Seleccione un campo...",autoWidth:!0,menuProps:{showArrow:!0}},Object.keys(L).map((e=>i.default.createElement("option",{key:e,value:e},L[e]))))),"Subtipo_Accidente"===t&&E(_),"Factor_Concurrente_3"===t&&E(_),i.default.createElement(l.SettingSection,{className:"attribute-selector-section"},i.default.createElement(d.Button,{onClick:()=>{C(!0),e.onRun(!0)},size:"sm"},"Ejecutar"),A&&i.default.createElement(d.Loading,{height:200,type:"DONUT",width:200})))}},3250:(e,o,t)=>{"use strict";var r=t(1315),a="function"==typeof Object.is?Object.is:function(e,o){return e===o&&(0!==e||1/e==1/o)||e!=e&&o!=o},n=r.useState,i=r.useEffect,l=r.useLayoutEffect,c=r.useDebugValue;function s(e){var o=e.getSnapshot;e=e.value;try{var t=o();return!a(e,t)}catch(e){return!0}}var d="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,o){return o()}:function(e,o){var t=o(),r=n({inst:{value:t,getSnapshot:o}}),a=r[0].inst,d=r[1];return l((function(){a.value=t,a.getSnapshot=o,s(a)&&d({inst:a})}),[e,t,o]),i((function(){return s(a)&&d({inst:a}),e((function(){s(a)&&d({inst:a})}))}),[e]),c(t),t};o.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:d},139:(e,o,t)=>{"use strict";var r=t(1315),a=t(1688),n="function"==typeof Object.is?Object.is:function(e,o){return e===o&&(0!==e||1/e==1/o)||e!=e&&o!=o},i=a.useSyncExternalStore,l=r.useRef,c=r.useEffect,s=r.useMemo,d=r.useDebugValue;o.useSyncExternalStoreWithSelector=function(e,o,t,r,a){var u=l(null);if(null===u.current){var m={hasValue:!1,value:null};u.current=m}else m=u.current;u=s((function(){function e(e){if(!c){if(c=!0,i=e,e=r(e),void 0!==a&&m.hasValue){var o=m.value;if(a(o,e))return l=o}return l=e}if(o=l,n(i,e))return o;var t=r(e);return void 0!==a&&a(o,t)?o:(i=e,l=t)}var i,l,c=!1,s=void 0===t?null:t;return[function(){return e(o())},null===s?void 0:function(){return e(s())}]}),[o,t,r,a]);var p=i(e,u[0],u[1]);return c((function(){m.hasValue=!0,m.value=p}),[p]),d(p),p}},1688:(e,o,t)=>{"use strict";e.exports=t(3250)},2798:(e,o,t)=>{"use strict";e.exports=t(139)},6849:e=>{"use strict";e.exports=l},2618:e=>{"use strict";e.exports=c},6826:e=>{"use strict";e.exports=n},8891:e=>{"use strict";e.exports=t},1315:e=>{"use strict";e.exports=r},800:e=>{"use strict";e.exports=a},726:e=>{"use strict";e.exports=s},7756:e=>{"use strict";e.exports=i}},o={};function d(t){var r=o[t];if(void 0!==r)return r.exports;var a=o[t]={exports:{}};return e[t](a,a.exports,d),a.exports}d.d=(e,o)=>{for(var t in o)d.o(o,t)&&!d.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:o[t]})},d.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o),d.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},d.p="";var u={};return d.p=window.jimuConfig.baseUrl,(()=>{"use strict";d.r(u),d.d(u,{__set_webpack_public_path__:()=>T,default:()=>x});var e=d(8891),o=d(1688),t=d(2798),r=d(800);let a=null;var n=d(1315);const i=Symbol.for("react-redux-context"),l="undefined"!=typeof globalThis?globalThis:{};function c(){var e;if(!n.createContext)return{};const o=null!=(e=l[i])?e:l[i]=new Map;let t=o.get(n.createContext);return t||(t=n.createContext(null),o.set(n.createContext,t)),t}const s=c();function m(e=s){return function(){return(0,n.useContext)(e)}}const p=m();let b=null;d(8679),d(2973),"undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?n.useLayoutEffect:n.useEffect;let g=null;function f(e=s){const o=e===s?p:m(e);return function(){const{store:e}=o();return e}}const S=f();function y(e=s){const o=e===s?S:f(e);return function(){return o().dispatch}}const _=y();b=t.useSyncExternalStoreWithSelector,(e=>{g=e})(o.useSyncExternalStore),a=r.unstable_batchedUpdates;var v=d(6826),h=d(6334);const{useState:w,useEffect:A,useRef:C}=e.React;function x(o){var t,r,a,n;const[i,l]=w({}),[c,s]=w(null),[d,u]=w([]),[m,p]=w(null),[b,g]=w(),[f,S]=w(!1),[y,x]=w(null),T=(C(null),_());function z(e,o,t,r,a){let n;n="column"===e?((e,o,t)=>{const r=[{type:"barSeries",id:"",name:"",x:o,y:"OBJECTID",colorType:"singleColor",stackedType:"stacked",fillSymbol:{type:"esriSFS",style:"esriSFSSolid",color:"#5E8FD0",outline:{type:"esriSLS",style:"esriSLSSolid",color:"var(--light-900)",width:0}},dataLabels:{type:"chartText",visible:!1,content:{type:"esriTS",color:"var(--dark-600)",font:{family:"Avenir Next",size:10,style:"normal",weight:"normal",decoration:"none"},horizontalAlignment:"center",verticalAlignment:"top"}},displayPercentageOnDataLabel:!0,displayNumericValueOnDataLabel:!1,dataLabelsOffset:5,rotated:!1,dataTooltipVisible:!0,query:{where:`${t}=''`}}];for(const a in e){const n={type:"barSeries",id:a,name:a,x:o,y:"OBJECTID",colorType:"singleColor",stackedType:"stacked",fillSymbol:{type:"esriSFS",style:"esriSFSSolid",color:`rgb(${e[a][0]}, ${e[a][1]}, ${e[a][2]})`,outline:{type:"esriSLS",style:"esriSLSSolid",color:"var(--light-900)",width:0}},dataLabels:{type:"chartText",visible:!1,content:{type:"esriTS",color:"var(--dark-600)",font:{family:"Avenir Next",size:10,style:"normal",weight:"normal",decoration:"none"},horizontalAlignment:"center",verticalAlignment:"top"}},rotated:!1,dataTooltipVisible:!0,query:{where:`${t}='${a}'`}};r.push(n)}const a={type:"barSeries",id:"__other-split-value__",name:"Undefined",x:o,y:"OBJECTID",colorType:"singleColor",stackedType:"stacked",fillSymbol:{type:"esriSFS",style:"esriSFSSolid",color:"#D6D6D6",outline:{type:"esriSLS",style:"esriSLSSolid",color:"var(--light-900)",width:0}},dataLabels:{type:"chartText",visible:!1,content:{type:"esriTS",color:"var(--dark-600)",font:{family:"Avenir Next",size:10,style:"normal",weight:"normal",decoration:"none"},horizontalAlignment:"center",verticalAlignment:"top"}},rotated:!1,dataTooltipVisible:!0,query:{where:"Tipo_accidente='__other-split-value__'"}};return r.push(a),r})(r,o,t):"widget_55"===a?((e,o)=>{const t=[{type:"pieSeries",colorType:"singleColor",id:"OBJECTID",name:"OBJECTID",x:e,y:"count_of_OBJECTID",innerRadius:0,startAngle:0,endAngle:360,displayNumericValueOnDataLabel:!0,displayPercentageOnDataLabel:!0,displayNumericValueOnTooltip:!0,displayPercentageOnTooltip:!0,dataLabelsOffset:-100,sliceGrouping:{sliceId:"__other-slice__",percentageThreshold:0,label:"Other",fillSymbol:{type:"esriSFS",style:"esriSFSSolid",color:"#D6D6D6",outline:{type:"esriSLS",style:"esriSLSSolid",color:"var(--light-100)",width:0}}},numericValueFormat:{type:"number",intlOptions:{style:"decimal",useGrouping:!0,minimumFractionDigits:0,maximumFractionDigits:1}},percentValueFormat:{type:"number",intlOptions:{style:"percent",notation:"standard",minimumFractionDigits:0,maximumFractionDigits:1}},fillSymbol:{type:"esriSFS",style:"esriSFSSolid",color:"#D6D6D6",outline:{type:"esriSLS",style:"esriSLSSolid",color:"var(--light-100)",width:0}},dataLabels:{type:"chartText",visible:!0,content:{type:"esriTS",color:"var(--dark-600)",font:{family:"Avenir Next",size:13,style:"normal",weight:"bold",decoration:"none"},horizontalAlignment:"center",verticalAlignment:"middle",wrap:!0,maxWidth:100}},dataTooltipVisible:!0,query:{where:`${e}=''`},slices:[{sliceId:"",label:"",fillSymbol:{type:"esriSFS",style:"esriSFSSolid",color:"#5E8FD0",outline:{type:"esriSLS",style:"esriSLSSolid",color:"var(--light-100)",width:0}}}]}];for(const e in o){const r={sliceId:e,label:e,fillSymbol:{type:"esriSFS",style:"esriSFSSolid",color:`rgb(${o[e][0]}, ${o[e][1]}, ${o[e][2]})`,outline:{type:"esriSLS",style:"esriSLSSolid",color:"var(--light-100)",width:0}}};t[0].slices.push(r)}return t})(t,r):((e,o)=>{const t=[{type:"pieSeries",colorType:"singleColor",id:"OBJECTID",name:"OBJECTID",x:e,y:"count_of_OBJECTID",innerRadius:0,startAngle:-90,endAngle:270,displayNumericValueOnDataLabel:!0,displayPercentageOnDataLabel:!1,displayNumericValueOnTooltip:!0,displayPercentageOnTooltip:!0,dataLabelsOffset:2,sliceGrouping:{sliceId:"__other-slice__",percentageThreshold:0,label:"Other",fillSymbol:{type:"esriSFS",style:"esriSFSSolid",color:"#D6D6D6",outline:{type:"esriSLS",style:"esriSLSSolid",color:"var(--light-100)",width:0}}},numericValueFormat:{type:"number",intlOptions:{style:"decimal",useGrouping:!0,minimumFractionDigits:0,maximumFractionDigits:3}},percentValueFormat:{type:"number",intlOptions:{style:"percent",notation:"standard",minimumFractionDigits:0,maximumFractionDigits:3}},fillSymbol:{type:"esriSFS",style:"esriSFSSolid",color:"#D6D6D6",outline:{type:"esriSLS",style:"esriSLSSolid",color:"var(--light-100)",width:0}},dataLabels:{type:"chartText",visible:!1,content:{type:"esriTS",color:"var(--dark-600)",font:{family:"Avenir Next",size:8,style:"normal",weight:"bold",decoration:"none"},horizontalAlignment:"center",verticalAlignment:"middle",wrap:!0,maxWidth:100}},dataTooltipVisible:!0,query:{where:`${e}=''`},slices:[{sliceId:"",label:"",fillSymbol:{type:"esriSFS",style:"esriSFSSolid",color:"#5E8FD0",outline:{type:"esriSLS",style:"esriSLSSolid",color:"var(--light-100)",width:0}}}]}];for(const e in o){const r={sliceId:e,label:e,fillSymbol:{type:"esriSFS",style:"esriSFSSolid",color:`rgb(${o[e][0]}, ${o[e][1]}, ${o[e][2]})`,outline:{type:"esriSLS",style:"esriSLSSolid",color:"var(--light-100)",width:0}}};t[0].slices.push(r)}return t})(t,r);const i=[{type:"chartAxis",visible:!0,isLogarithmic:!1,title:{type:"chartText",visible:!1,content:{type:"esriTS",color:"var(--dark-800)",font:{family:"Avenir Next",size:14,style:"normal",weight:"normal",decoration:"none"},horizontalAlignment:"center",verticalAlignment:"middle"}},labels:{type:"chartText",visible:!0,content:{type:"esriTS",color:"var(--dark-500)",font:{family:"Avenir Next",size:14,style:"normal",weight:"normal",decoration:"none"},horizontalAlignment:"center",verticalAlignment:"middle"}},valueFormat:{type:"category",characterLimit:11},lineSymbol:{type:"esriSLS",style:"esriSLSSolid",color:"var(--light-800)",width:1},grid:{type:"esriSLS",style:"esriSLSDash",color:"var(--light-300)",width:0}},{type:"chartAxis",visible:!0,isLogarithmic:!1,title:{type:"chartText",visible:!1,content:{type:"esriTS",color:"var(--dark-800)",font:{family:"Avenir Next",size:14,style:"normal",weight:"normal",decoration:"none"},horizontalAlignment:"center",verticalAlignment:"middle"}},labels:{type:"chartText",visible:!0,content:{type:"esriTS",color:"var(--dark-500)",font:{family:"Avenir Next",size:14,style:"normal",weight:"normal",decoration:"none"},horizontalAlignment:"center",verticalAlignment:"middle"}},valueFormat:{type:"number",intlOptions:{style:"decimal",useGrouping:!0,minimumFractionDigits:0,maximumFractionDigits:0}},lineSymbol:{type:"esriSLS",style:"esriSLSSolid",color:"var(--light-800)",width:1},grid:{type:"esriSLS",style:"esriSLSDash",color:"var(--light-300)",width:0}}],l={type:"chartText",visible:!0,content:{type:"esriTS",color:"var(--dark-800)",font:{family:"Avenir Next",size:14,style:"normal",weight:"normal",decoration:"none"},horizontalAlignment:"center",text:""}},c={type:"chartText",visible:!0,content:{type:"esriTS",color:"var(--black)",font:{family:"Avenir Next",size:24,style:"normal",weight:"normal",decoration:"none"},horizontalAlignment:"center",text:""}};return"column"===e?{tools:{cursorEnable:!0},template:e,webChart:{version:"7.3.1",id:e,type:"chart",axes:i,background:"var(--white)",dataSource:{query:{groupByFieldsForStatistics:[o],outStatistics:[{statisticType:"count",onStatisticField:"OBJECTID",outStatisticFieldName:"count_of_OBJECTID"}],orderByFields:[`${o} ASC`],where:`${t}={value}`}},footer:l,legend:{type:"chartLegend",visible:!1,layout:"vertical",labelMaxWidth:200,title:{type:"chartText",visible:!0,content:{type:"esriTS",color:"var(--dark-800)",font:{family:"Avenir Next",size:40,style:"normal",weight:"normal",decoration:"none"},horizontalAlignment:"center",text:""}},body:{type:"esriTS",color:"var(--dark-800)",font:{family:"Avenir Next",size:9,style:"normal",weight:"bold",decoration:"none"},horizontalAlignment:"center",text:""},position:"right"},sortLabelsBy:"originalValue",sortLabelsOrder:"ascending",rotated:!1,series:n,title:c}}:{tools:{cursorEnable:!0},template:e,webChart:{version:"7.3.1",id:e,type:"chart",axes:i,background:"var(--white)",dataSource:{query:{groupByFieldsForStatistics:[o],outStatistics:[{statisticType:"count",onStatisticField:"OBJECTID",outStatisticFieldName:"count_of_OBJECTID"}],orderByFields:["count_of_OBJECTID DESC"],where:""}},footer:l,legend:{type:"chartLegend",visible:!0,layout:"vertical",labelMaxWidth:200,title:{type:"chartText",visible:!0,content:{type:"esriTS",color:"var(--dark-800)",font:{family:"Avenir Next",size:40,style:"normal",weight:"normal",decoration:"none"},horizontalAlignment:"center",text:""}},body:{type:"esriTS",color:"var(--dark-800)",font:{family:"Avenir Next",size:9,style:"normal",weight:"bold",decoration:"none"},horizontalAlignment:"center",text:""},position:"right"},sortLabelsBy:"originalValue",sortLabelsOrder:"descending",rotated:!1,series:n,title:c}}}function O(o,t,r){const a=(0,e.getAppStore)(),n=function(e){const o=e=>{if("string"==typeof e)return e;if(Array.isArray(e)&&e.length>=3){const[o,t,r]=e;return`rgb(${o}, ${t}, ${r})`}},t={};for(const[r,a]of Object.entries(e||{})){const e=o(a);e&&(t[r]=e)}return t}(r);console.log("baseColorMap",n);const i=Array.isArray(window.attUnique)?window.attUnique.map((e=>String(e))):[],l=Object.keys(r||{}),c=Object.keys(n||{}),s=Array.from(new Set([...i,...l,...c].map((e=>String(e))))),d=window.valoresAgg||[],u=new Set(d.map((e=>String(e)))),m={};s.forEach((e=>{const o=String(e),t=(e=>{const o=e.trim().toLowerCase(),t=Object.keys(n).find((e=>e.trim().toLowerCase()===o));return t?n[t]:void 0})(o);!u.size||u.has(o)?m[o]=t||"GRIS_RESTO":m[o]="#dcdcdc"})),console.log("Colores gráfico grande",m),window.SimbologiaSeleccionada=t,window.valoresSeleccionados=s,a.dispatch(e.appActions.widgetStatePropChange(o,"categoryFieldOverride",t)),a.dispatch(e.appActions.widgetStatePropChange(o,"categoryColorsOverride",m)),a.dispatch(e.appActions.widgetStatePropChange(o,"categoryValuesOverride",s))}return A((()=>{if(b){const o=(0,e.getAppStore)().getState().appConfig;o.lastFilter=b.view.map.layers.items[17].definitionExpression,f&&(o.counter=o.counter?o.counter+1:1),T({type:"CHART_EJECUTADO"})}}),[f]),A((()=>{if(y&&f){const o={widget_2:m,widget_4:"Año",widget_5:"Mes",widget_6:"Dia",widget_7:"Mes_Año",widget_9:"PK",widget_10:"Kilometro",widget_102:"Año",widget_58:"Mes",widget_85:"Dia",widget_60:"Mes_Año",widget_68:"PK",widget_67:"Kilometro",widget_55:m,widget_132:"Año",widget_168:m,widget_159:"Año",widget_160:"Mes",widget_161:"Dia",widget_162:"Mes_Año",widget_172:"Kilometro",widget_173:"PK"};for(const t in d)"widget_2"===d[t].id?(0,e.getAppStore)().dispatch(e.appActions.widgetConfigLoaded(d[t].id,z("pie",o[d[t].id],m,y,d[t].id))):"widget_89"===d[t].id||(0,e.getAppStore)().dispatch(e.appActions.widgetConfigLoaded(d[t].id,z("column",o[d[t].id],m,y,null))),O("widget_168",m,y);(0,e.getAppStore)().getState().appConfig.campo=m,S(!1)}}),[m,y]),A((()=>{const o=(0,e.getAppStore)().getState().appConfig.widgets;l(o),s("widget_4")}),[]),A((()=>{var t,r;const a=null===(t=null==o?void 0:o.stateProps)||void 0===t?void 0:t.campo,n=null===(r=null==o?void 0:o.stateProps)||void 0===r?void 0:r.applyClusterChartsTrigger;"Tipo_accidente"===a&&n&&(0,e.getAppStore)().dispatch(e.appActions.widgetStatePropChange(o.id,"applyClusterChartsTrigger",0))}),[null===(t=null==o?void 0:o.stateProps)||void 0===t?void 0:t.campo,null===(r=null==o?void 0:o.stateProps)||void 0===r?void 0:r.applyClusterChartsTrigger]),A((()=>{if(i){const e=Object.values(i);u(e.filter((e=>"widgets/common/chart/"===e.uri)))}}),[i]),A((()=>{var t;(null===(t=null==o?void 0:o.stateProps)||void 0===t?void 0:t.restartTrigger)&&(function(){try{p(null),S(!1),x(null)}catch(e){console.warn("[widget_14] handleRestart error:",e)}}(),(0,e.getAppStore)().dispatch(e.appActions.widgetStatePropChange(o.id,"restartTrigger",0)))}),[null===(a=null==o?void 0:o.stateProps)||void 0===a?void 0:a.restartTrigger]),e.React.createElement("div",null,o.useMapWidgetIds&&1===o.useMapWidgetIds.length&&e.React.createElement(v.JimuMapViewComponent,{useMapWidgetId:null===(n=o.useMapWidgetIds)||void 0===n?void 0:n[0],onActiveViewChange:e=>{e&&g(e)}}),e.React.createElement("div",null,e.React.createElement(h.default,Object.assign({},o,{onUpdate:e=>{p(e)},onRun:e=>{S(e)},onAtt:e=>{x(e)}}))))}function T(e){d.p=e}})(),u})())}}}));